[Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:07,  1.98s/it][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:02,  1.48it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.30s/it]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.14it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:02,  1.38it/s][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.01it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.48it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.04s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.40it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.10s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.17it/s][Seed] All random states set to 42
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.43it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.01it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.15s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.31it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.04s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.11it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.06s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:02<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.29it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.01it/s]
Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.13s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.81it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.61it/s]
Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.01s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:02<00:00,  1.33it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.06s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.84it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.58it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.15it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:01,  1.00it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.59it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.35it/s]
Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.09it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.11it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.05it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.54it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.26it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.08it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.20it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.49it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.23it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.12it/s]The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.55it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.25it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.27it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.75it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.41it/s]
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 1/7 [00:30<03:02, 30.47s/it]Processing batches:  29%|██▊       | 2/7 [01:11<03:03, 36.75s/it]Processing batches:   0%|          | 0/7 [01:47<?, ?it/s]
Error parsing JSON: [
	{"bbox_2d": [490,,-1,3999,3999], "label": "\"in the picture, there is a type of bird with a distinctive feature on the top of its head, which usually indicates its gender. what part in the picture might have this characteristic\""}
]
Traceback (most recent call last):
  File "/home/dexter/VisionReasoner/evaluation/evaluation_segmentation.py", line 278, in <module>
    main()
  File "/home/dexter/VisionReasoner/evaluation/evaluation_segmentation.py", line 150, in main
    process_batch(model, batch_images, batch_questions, id_list, all_outputs, has_bbox,
  File "/home/dexter/VisionReasoner/evaluation/evaluation_segmentation.py", line 210, in process_batch
    batch_results = model.segment_objects_batch(batch_images, batch_questions)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dexter/VisionReasoner/vision_reasoner/models/qwen_vl.py", line 484, in segment_objects_batch
    result = self.segment_objects(image, query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dexter/VisionReasoner/vision_reasoner/models/qwen_vl.py", line 436, in segment_objects
    int(item[key][2] * x_factor),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'list'
evaluation/eval_segmentation.sh: line 51: kill: (-2455811) - No such process
Processing batches:  43%|████▎     | 3/7 [02:02<02:52, 43.21s/it]Processing batches:  14%|█▍        | 1/7 [01:56<11:39, 116.51s/it]Processing batches:  14%|█▍        | 1/7 [02:06<12:39, 126.59s/it]Processing batches:  14%|█▍        | 1/7 [01:58<11:49, 118.26s/it]Processing batches:  14%|█▍        | 1/7 [02:26<14:38, 146.47s/it]Processing batches:  14%|█▍        | 1/7 [02:33<15:21, 153.66s/it]Processing batches:  57%|█████▋    | 4/7 [02:42<02:05, 41.80s/it]Processing batches:  14%|█▍        | 1/7 [02:28<14:50, 148.42s/it]Processing batches:  29%|██▊       | 2/7 [03:03<06:50, 82.12s/it] Processing batches:  71%|███████▏  | 5/7 [03:25<01:24, 42.32s/it]Processing batches:  29%|██▊       | 2/7 [03:42<09:02, 108.44s/it]Processing batches:  43%|████▎     | 3/7 [03:37<04:00, 60.07s/it]Processing batches:  86%|████████▌ | 6/7 [03:53<00:37, 37.46s/it]Processing batches: 100%|██████████| 7/7 [03:59<00:00, 27.29s/it]Processing batches: 100%|██████████| 7/7 [03:59<00:00, 34.25s/it]
Error parsing JSON: [
	{"bbox_2d": [285, 163,="what object can people use to listen to music, watch videos, or read e-books before going to bed", "bbox_2d": [285, 163,]
Error parsing JSON: [
	{"bbox_2d": [257 [106 143] 278 185], "label": "\"when reading in bed at night, what object in the pictures is often used to illuminate the pages so that they are visible\""}
]
Processing batches:  57%|█████▋    | 4/7 [04:12<02:30, 50.17s/it]Processing batches:  29%|██▊       | 2/7 [04:20<11:02, 132.40s/it]Processing batches:  29%|██▊       | 2/7 [04:25<11:17, 135.48s/it]Processing batches:  29%|██▊       | 2/7 [04:27<10:54, 130.93s/it]Processing batches:  71%|███████▏  | 5/7 [04:41<01:25, 42.68s/it]Processing batches:  29%|██▊       | 2/7 [04:53<12:09, 145.82s/it]Processing batches:  86%|████████▌ | 6/7 [05:05<00:36, 36.31s/it]Processing batches: 100%|██████████| 7/7 [05:08<00:00, 25.45s/it]Processing batches: 100%|██████████| 7/7 [05:08<00:00, 44.11s/it]
Error parsing JSON: [
	{"bbox_2d": [156, 57, 286, nineteen], "label": "\"visitors in the waiting room will be bored and may need to temporarily place personal belongings while waiting. what furniture are they likely to use for temporary storage\""}
]
Error parsing JSON: [
	{"bbox_2d": [159, 83, 247, eleven6], "label": "\"when we enter a room, what object can be used to remove dirt and moisture from shoes, and avoid slipping hazards indoors\""}
]
Error parsing JSON: [
	{"bbox_2d": [176,.Clamp(176, 230), 202, 234], "label": "what appliance in the image can be used to control lighting in this room"}
]
Processing batches:  43%|████▎     | 3/7 [05:41<07:32, 113.18s/it]Processing batches:  43%|████▎     | 3/7 [06:03<07:56, 119.22s/it]Processing batches:  43%|████▎     | 3/7 [06:25<08:20, 125.25s/it]Processing batches:  43%|████▎     | 3/7 [06:39<08:29, 127.35s/it]Processing batches:  43%|████▎     | 3/7 [06:39<08:58, 134.60s/it]Processing batches:  57%|█████▋    | 4/7 [07:20<05:23, 107.86s/it]Processing batches:  57%|█████▋    | 4/7 [08:09<06:05, 121.97s/it]Processing batches:  57%|█████▋    | 4/7 [08:21<05:51, 117.32s/it]Processing batches:  57%|█████▋    | 4/7 [08:33<06:19, 126.65s/it]Processing batches:  57%|█████▋    | 4/7 [08:58<06:48, 136.18s/it]Processing batches:  71%|███████▏  | 5/7 [09:18<03:42, 111.40s/it]Processing batches:  71%|███████▏  | 5/7 [09:44<03:30, 105.08s/it]Processing batches:  71%|███████▏  | 5/7 [09:46<03:45, 112.89s/it]Processing batches:  86%|████████▌ | 6/7 [10:50<01:31, 91.87s/it] Processing batches:  71%|███████▏  | 5/7 [10:56<04:25, 132.61s/it]Processing batches: 100%|██████████| 7/7 [11:02<00:00, 65.55s/it]Processing batches: 100%|██████████| 7/7 [11:02<00:00, 94.61s/it]
Processing batches:  86%|████████▌ | 6/7 [11:19<01:54, 114.69s/it]Processing batches:  86%|████████▌ | 6/7 [11:09<01:42, 102.88s/it]Processing batches: 100%|██████████| 7/7 [11:23<00:00, 78.31s/it] Processing batches: 100%|██████████| 7/7 [11:23<00:00, 97.57s/it]
Error parsing JSON: [
	{"bbox_2d": [109, 0, get_face(364, 50)], "label": "\"in a high-energy sporting event, the audience often cheers for the athletes to show their support and excitement. what object or area in the picture could the spectators be directing their cheers towards\""}
]
Processing batches: 100%|██████████| 7/7 [11:13<00:00, 70.46s/it] Processing batches: 100%|██████████| 7/7 [11:13<00:00, 96.24s/it]
Error parsing JSON: [
	{"bbox_2d": [0, 1,}]}
Error parsing JSON: [
	{"bbox_2d": [805, 1603,�917, 1934], "label": "\"at a dinner party, a guest may be asked to carve a cake or pie to serve to the other guests. what object in the picture could be used to cut the cake or pie\""}
]
Processing batches:  71%|███████▏  | 5/7 [11:32<04:45, 142.64s/it]Processing batches:  86%|████████▌ | 6/7 [13:37<02:16, 136.47s/it]Processing batches:  86%|████████▌ | 6/7 [13:49<02:26, 146.32s/it]Processing batches: 100%|██████████| 7/7 [13:51<00:00, 96.55s/it] Processing batches: 100%|██████████| 7/7 [13:51<00:00, 118.78s/it]
Error parsing JSON: [
	{"bbox_2d": <0, 619, 3405, 2628>, "label": "\"when using a film camera, what component in the picture is typically used to attach the camera to a person's body for easy carrying and accessibility\""}
]
Processing batches: 100%|██████████| 7/7 [13:56<00:00, 100.70s/it]Processing batches: 100%|██████████| 7/7 [13:56<00:00, 119.53s/it]
gIoU (average of per image IoU): 0.4972
cIoU (total_intersection / total_union): 0.4002
bbox_AP (average of per image bbox_AP): 0.5584
