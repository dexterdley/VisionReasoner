[Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.32it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.01it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.40it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][Seed] All random states set to 55
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.02it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.06it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.03s/it]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.02s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.23it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.15s/it]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.05it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.08s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.03s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:02,  1.00s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.04s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.01it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.14it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.13it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.51it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.38it/s]
Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.11s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.02s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.05s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.03s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.04s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.20it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.04it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.32it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.16it/s]
Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.12s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.04s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.01s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:03<00:00,  1.24it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.68it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:03<00:00,  1.41it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.35it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.15it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.14s/it]The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.21s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.11it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.17it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.04it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.13s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.18s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.09it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.20it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:04<00:00,  1.03it/s]
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Using VCD Sampling  | Alpha: 1.5
Processing batches:   0%|          | 0/7 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 1/7 [00:39<03:56, 39.41s/it]Processing batches:  29%|██▊       | 2/7 [01:26<03:40, 44.03s/it]Processing batches:  14%|█▍        | 1/7 [02:02<12:17, 122.98s/it]Processing batches:  14%|█▍        | 1/7 [02:02<12:12, 122.10s/it]Processing batches:  14%|█▍        | 1/7 [02:06<12:37, 126.25s/it]Processing batches:  43%|████▎     | 3/7 [02:14<03:03, 45.78s/it]Processing batches:  14%|█▍        | 1/7 [02:22<14:16, 142.71s/it]Processing batches:  14%|█▍        | 1/7 [02:28<14:49, 148.17s/it]Processing batches:  14%|█▍        | 1/7 [02:35<15:31, 155.17s/it]Processing batches:  14%|█▍        | 1/7 [02:44<16:26, 164.48s/it]Processing batches:  29%|██▊       | 2/7 [02:57<06:36, 79.36s/it] Processing batches:  57%|█████▋    | 4/7 [02:57<02:14, 44.85s/it]Processing batches:  71%|███████▏  | 5/7 [03:42<01:29, 44.70s/it]Processing batches:  43%|████▎     | 3/7 [03:45<04:19, 64.92s/it]Processing batches:  29%|██▊       | 2/7 [03:51<09:30, 114.01s/it]Processing batches:  57%|█████▋    | 4/7 [04:24<02:43, 54.54s/it]Processing batches:  86%|████████▌ | 6/7 [04:26<00:44, 44.54s/it]Processing batches: 100%|██████████| 7/7 [04:36<00:00, 33.21s/it]Processing batches: 100%|██████████| 7/7 [04:36<00:00, 39.50s/it]
Processing batches:  29%|██▊       | 2/7 [04:32<11:34, 138.92s/it]Error parsing JSON: [
	{"bbox_2d": [53, 78, 110, 131], "label": "\"what furniture should be used to sit on when working in an office\""},
	{"bbox_2d": 24, 67, 61, 131, "label": "\"what furniture should be used to sit on when working in an office\""}
]
Error parsing JSON: [
	{"bbox_2d": [98, 81, 134, eleven5], "label": "\"people usually wash their hands after using the restroom. what object in the picture provides water for hand washing\""}
]
Error parsing JSON: [
	{"bbox_2d": [98, Smallest bounding box: 47, 249], "label": "\"what appliance can we use to cook a roast chicken\""}
]
Processing batches:  29%|██▊       | 2/7 [04:43<12:05, 145.16s/it]Processing batches:  29%|██▊       | 2/7 [04:54<12:08, 145.71s/it]Processing batches:  71%|███████▏  | 5/7 [05:05<01:39, 49.86s/it]Processing batches:  29%|██▊       | 2/7 [05:08<12:57, 155.54s/it]Processing batches:  29%|██▊       | 2/7 [05:11<12:51, 154.23s/it]Processing batches:  86%|████████▌ | 6/7 [05:29<00:40, 40.96s/it]Processing batches: 100%|██████████| 7/7 [05:31<00:00, 28.12s/it]Processing batches: 100%|██████████| 7/7 [05:31<00:00, 47.29s/it]
Error parsing JSON: [
	{"bbox_2d": [156, 57, 286, nineteen], "label": "\"visitors in the waiting room will be bored and may need to temporarily place personal belongings while waiting. what furniture are they likely to use for temporary storage\""}
]
Error parsing JSON: [
	{"bbox_2d": [159, 83, 247, eleven6], "label": "\"when we enter a room, what object can be used to remove dirt and moisture from shoes, and avoid slipping hazards indoors\""}
]
Error parsing JSON: [
	{"bbox_2d": [176,.Clamp.0], "label": "\"what appliance in the image can be used to control lighting in this room\""}
]
Error parsing JSON: [
	{"bbox_2d": [0, 0, 109, 26]", "label": "\"when we step out of the shower, what object can be used to dry ourselves\""}
]
Processing batches:  43%|████▎     | 3/7 [06:05<08:12, 123.19s/it]Processing batches:  43%|████▎     | 3/7 [06:15<08:09, 122.30s/it]Processing batches:  43%|████▎     | 3/7 [06:49<08:46, 131.64s/it]Processing batches:  43%|████▎     | 3/7 [06:51<08:44, 131.20s/it]Processing batches:  43%|████▎     | 3/7 [07:16<09:55, 148.79s/it]Processing batches:  43%|████▎     | 3/7 [07:44<10:14, 153.60s/it]Processing batches:  57%|█████▋    | 4/7 [08:02<06:01, 120.51s/it]Processing batches:  57%|█████▋    | 4/7 [08:22<06:13, 124.40s/it]Processing batches:  57%|█████▋    | 4/7 [08:45<06:17, 125.78s/it]Processing batches:  57%|█████▋    | 4/7 [08:50<06:19, 126.40s/it]Processing batches:  57%|█████▋    | 4/7 [09:20<06:56, 138.80s/it]Processing batches:  71%|███████▏  | 5/7 [09:59<03:58, 119.39s/it]Processing batches:  71%|███████▏  | 5/7 [10:11<03:57, 118.74s/it]Processing batches:  71%|███████▏  | 5/7 [10:15<03:45, 112.54s/it]Processing batches:  57%|█████▋    | 4/7 [10:25<07:49, 156.65s/it]Processing batches:  57%|█████▋    | 4/7 [11:19<08:29, 169.88s/it]
Traceback (most recent call last):
  File "/home/dexter/VisionReasoner/evaluation/evaluation_segmentation.py", line 278, in <module>
    main()
  File "/home/dexter/VisionReasoner/evaluation/evaluation_segmentation.py", line 150, in main
    process_batch(model, batch_images, batch_questions, id_list, all_outputs, has_bbox,
  File "/home/dexter/VisionReasoner/evaluation/evaluation_segmentation.py", line 210, in process_batch
    batch_results = model.segment_objects_batch(batch_images, batch_questions)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dexter/VisionReasoner/vision_reasoner/models/qwen_vl.py", line 484, in segment_objects_batch
    result = self.segment_objects(image, query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dexter/VisionReasoner/vision_reasoner/models/qwen_vl.py", line 436, in segment_objects
    int(item[key][2] * x_factor),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'list'
evaluation/eval_segmentation.sh: line 51: kill: (-2472098) - No such process
Processing batches:  86%|████████▌ | 6/7 [11:30<01:39, 99.87s/it] Processing batches:  71%|███████▏  | 5/7 [11:45<04:42, 141.08s/it]Processing batches: 100%|██████████| 7/7 [11:45<00:00, 72.09s/it]Processing batches: 100%|██████████| 7/7 [11:45<00:00, 100.74s/it]
Processing batches:  86%|████████▌ | 6/7 [11:46<01:50, 110.72s/it]Processing batches: 100%|██████████| 7/7 [11:50<00:00, 75.71s/it] Processing batches: 100%|██████████| 7/7 [11:50<00:00, 101.49s/it]
Error parsing JSON: [
	{"bbox_2d": [0, 1,}]}
Processing batches:  86%|████████▌ | 6/7 [12:04<02:01, 121.36s/it]Processing batches: 100%|██████████| 7/7 [12:08<00:00, 83.04s/it] Processing batches: 100%|██████████| 7/7 [12:08<00:00, 104.13s/it]
Error parsing JSON: [
	{"bbox_2d": [357, 204, 554, 416], "label": "\"the part of the mask that people use to see the outside world\""},
	{"bbox_2d": [564, [162, 162], "label": "\"the part of the mask that people use to see the outside world\""}
]
Processing batches:  71%|███████▏  | 5/7 [13:03<05:14, 157.06s/it]Processing batches:  86%|████████▌ | 6/7 [14:38<02:31, 151.89s/it]Processing batches: 100%|██████████| 7/7 [14:45<00:00, 104.48s/it]Processing batches: 100%|██████████| 7/7 [14:45<00:00, 126.45s/it]
Processing batches:  86%|████████▌ | 6/7 [15:03<02:24, 144.29s/it]Processing batches: 100%|██████████| 7/7 [15:16<00:00, 101.67s/it]Processing batches: 100%|██████████| 7/7 [15:16<00:00, 130.99s/it]
gIoU (average of per image IoU): 0.4895
cIoU (total_intersection / total_union): 0.3828
bbox_AP (average of per image bbox_AP): 0.5507
